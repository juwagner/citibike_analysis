###
rm(list = ls(all.names = TRUE))
gc()
options(scipen = 999)
library(tidyverse)
library(data.table)
library(scales)
source("./src/viz_functions.R")
citibike_data <- readRDS("./data/citibike_data_clean.rds")
source("./src/viz_functions.R")
citibike_data <- readRDS("./data/citibike_data_clean.rds")
my_barchart_fct(citibike_data, x_var = "hour", by_var = c("hour", "usertype"),
fill_var = "usertype", position = "dodge")
ggplot(citibike_data, aes(x = "" , y = tripduration)) +
geom_violin() +
labs(title = "Tripduration per usertype", x = "",
y = "tripduration [in minutes]") +
facet_grid(~usertype)
ggplot(citibike_data, aes(x = dayofweek , y = tripduration, group = dayofweek)) +
geom_violin() +
labs(title = "Tripduration per usertype and day of week", x = "dayofweek",
y = "tripduration [in minutes]") +
facet_grid(~usertype)
ggplot(citibike_data[, .("avg" = mean(tripduration)), by = .(month, usertype)],
aes(x = month, y = avg, group = usertype, color = usertype)) +
geom_line() +
labs(x = "month", y = "average tripduration") +
scale_color_manual(values = mycols)
